---
title: "Data 621 Homework 4"
author: "Sung Lee"
date: "11/18/2021"
output: 
  html_document:
    code_folding: show
    df_print: paged
    smooth_scroll: false
number_sections: true
theme: paper
---

# Introduction  
In this homework assignment, you will explore, analyze and model a data set containing approximately 8000
records representing a customer at an auto insurance company. Each record has two response variables. The
first response variable, TARGET_FLAG, is a 1 or a 0. A “1” means that the person was in a car crash. A zero
means that the person was not in a car crash. The second response variable is TARGET_AMT. This value is zero
if the person did not crash their car. But if they did crash their car, this number will be a value greater than zero.  

Your objective is to build multiple linear regression and binary logistic regression models on the training data
to predict the probability that a person will crash their car and also the amount of money it will cost if the person
does crash their car. You can only use the variables given to you (or variables that you derive from the variables
provided). Below is a short description of the variables of interest in the data set:



Variable | Description
---------|-------------------------  
INDEX| Identification Variable (do not use)
TARGET_FLAG| Was Car in a crash? 1=YES 0=NO
TARGET_AMT|If car was in a crash, what was the cost
AGE| Age of Driver 
BLUEBOOK| Value of Vehicle
CAR_AGE| Vehicle Age
CAR_TYPE| Type of Car
CAR_USE| Vehicle Use
CLM_FREQ| # Claims (Past 5 Years)
EDUCATION| Max Education Level
HOMEKIDS| # Children at Home
HOME_VAL| Home Value
INCOME| Income
JOB| Job Category
KIDSDRIV| # Driving Children
MSTATUS| Marital Status
MVR_PTS| Motor Vehicle Record Points
OLDCLAIM| Total Claims (Past 5 Years)
PARENT1| Single Parent
RED_CAR| A Red Car
REVOKED| License Revoked (Past 7 Years)
SEX| Gender
TIF| Time in Force
TRAVTIME| Distance to Work
URBANICITY| Home/Work Area
YOJ| Years on Job  

```{r, echo=FALSE, warning=FALSE}
library(pastecs)
library(tidyverse)
# https://www.rdocumentation.org/packages/naniar/versions/0.6.1
library(naniar)
library(reshape2)
library(ggplot2)

# Used for skewness
library(moments)

# Log Scale
library(scales)

# Correlation corrplot
# https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html
library(corrplot)

# https://www.rdocumentation.org/packages/car/versions/3.0-11/topics/vif
library(car)

library(caret)
library(leaps)
library(pROC)
```  

# Data Exploration  

```{r, echo=FALSE}
# To help prevent scientific notation for viewed values
options(scipen=100)

# To set the number of decimal places
options(digits=4)

# From http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_(ggplot2)/
# Multiple plot function
#
# ggplot objects can be passed in ..., or to plotlist (as a list of ggplot objects)
# - cols:   Number of columns in layout
# - layout: A matrix specifying the layout. If present, 'cols' is ignored.
#
# If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE),
# then plot 1 will go in the upper left, 2 will go in the upper right, and
# 3 will go all the way across the bottom.
#
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)

  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)

  numPlots = length(plots)

  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
                    ncol = cols, nrow = ceiling(numPlots/cols))
  }

 if (numPlots==1) {
    print(plots[[1]])

  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))

    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))

      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}


# Reading in the csv files
trainData <- read.csv("https://raw.githubusercontent.com/logicalschema/Fall-2021/main/DATA621/hw4/insurance_training_data.csv")

evalData <- read.csv("https://raw.githubusercontent.com/logicalschema/Fall-2021/main/DATA621/hw4/insurance-evaluation-data.csv")

```

The following is a snippet of the training data along with summary and other statistics:

```{r, echo=FALSE}
head(trainData)
summary(trainData)

# https://cran.r-project.org/web/packages/pastecs/pastecs.pdf
stat.desc(trainData, basic = FALSE)
```  



